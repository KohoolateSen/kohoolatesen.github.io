<!doctype html><html data-theme=dark lang=en xmlns=http://www.w3.org/1999/xhtml><head><meta charset=UTF-8><meta content="PRESS ENTER TO START" name=description><meta content="width=device-width,initial-scale=1" name=viewport><meta content=#00cf37 name=theme-color><meta content=#00cf37 media=(prefers-color-scheme:dark) name=theme-color><meta content="default-src 'none';font-src 'self';img-src 'self' https: data:;media-src 'self' https:;style-src 'self' 'unsafe-inline';frame-src https://player.vimeo.com https://www.youtube-nocookie.com https://toot.community;base-uri 'none';form-action 'none';connect-src 'self' https://duckquill.goatcounter.com/count https://vmst.io https://toot.community;script-src 'self' https://duckquill.goatcounter.com/count 'self'" http-equiv=content-security-policy><title>BCP38, The Guardian Against IP Spoofing - Retrobute</title><link href=https://retrobute.github.io/blog/bcp38/ rel=canonical><link href=https://vmst.io/@daudix rel=me><meta content=@daudix@vmst.io name=fediverse:creator><link href=https://retrobute.github.io/favicon.png rel=icon type=image/png><link href=https://retrobute.github.io/apple-touch-icon.png rel=apple-touch-icon sizes=180x180 type=image/png><link href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext x='-.07em' y='.89em' font-size='90'%3EðŸ‘¾%3C/text%3E%3C/svg%3E" rel=icon><link title="Retrobute - RSS Feed" href=https://retrobute.github.io/rss.xml rel=alternate type=application/rss+xml><link title="Retrobute - Atom Feed" href=https://retrobute.github.io/atom.xml rel=alternate type=application/atom+xml><style>:root,[data-theme=dark]{--accent-color:#00cf37}@media (prefers-color-scheme:dark){:root:not([data-theme=light]){--accent-color:#00cf37}}</style><link href=https://retrobute.github.io/style.css rel=stylesheet><link href=https://retrobute.github.io/css/mods.css rel=stylesheet><link href=https://retrobute.github.io/css/styles.css rel=stylesheet><link href=https://retrobute.github.io/css/fonts.css rel=stylesheet><link media="(prefers-color-scheme: light)" href=https://retrobute.github.io/syntax-theme-light.css rel=stylesheet><link media="(prefers-color-scheme: dark)" href=https://retrobute.github.io/syntax-theme-dark.css rel=stylesheet><script defer src=https://retrobute.github.io/closable.js></script><script defer src=https://retrobute.github.io/copy-button.js></script><script data-goatcounter=https://duckquill.goatcounter.com/count defer src=https://retrobute.github.io/count.js></script><script defer src=https://retrobute.github.io/fuse.js></script><script defer src=https://retrobute.github.io/search-fuse.js></script><script defer src=https://retrobute.github.io/theme-switcher.js></script><script defer src=https://retrobute.github.io/scripts/typewriter.js></script><script defer src=https://retrobute.github.io/scripts/typewriter-core.js></script><meta content=Retrobute property=og:site_name><meta content="BCP38, The Guardian Against IP Spoofing - Retrobute" property=og:title><meta content=https://retrobute.github.io/blog/bcp38/ property=og:url><meta content="How BCP38 acts as the frontline defense against IP spoofing, securing networks and mitigating DDoS attacks. (my very first blog post lol)" property=og:description><meta content=https://retrobute.github.io/card.png property=og:image><meta content=en_US property=og:locale><body><header id=site-nav><nav><a href=#main-content tabindex=0> Skip to Main Content </a><ul><li id=home><a href=https://retrobute.github.io> <i class=icon></i>Retrobute</a><li class=divider><li><a href=https://retrobute.github.io/about/>About</a><li><a href=https://retrobute.github.io/blog/>Blog</a><li><a class=external href=https://github.com/Retrobute>Github</a><li id=search><button class=circle id=search-toggle title=Search><i class=icon></i></button><li id=theme-switcher><details class=closable><summary class=circle title=Theme><i class=icon></i></summary> <ul><li><button title="Switch to Light Theme" class=circle id=theme-light><i class=icon></i></button><li><button title="Switch to Dark Theme" class=circle id=theme-dark><i class=icon></i></button><li><button title="Use System Theme" class=circle id=theme-system><i class=icon></i></button></ul></details><li id=feed><details class=closable><summary class=circle title=Feed><i class=icon></i></summary> <ul><li><a href=https://retrobute.github.io/rss.xml>RSS</a><li><a href=https://retrobute.github.io/atom.xml>Atom</a></ul></details></ul></nav><div id=search-container><label class=visually-hidden for=search-bar>Search</label><input placeholder="Search forâ€¦" autocomplete=off disabled id=search-bar type=search><div id=search-results-container><div id=search-results></div></div></div></header><main id=main-content><article><div id=heading><p><small> <time datetime=" 2025-05-16T00:00:00+00:00">Published on May 16, 2025</time></small><h1>BCP38, The Guardian Against IP Spoofing</h1><p><small><span>By KohoolateSen</span><span> â€¢ </span><span>4 minutes read</span><span> â€¢ </span></small><ul class=tags><a class=tag href=https://retrobute.github.io/tags>tags:</a><li><a class=tag href=https://retrobute.github.io/tags/bcp38/>BCP38</a><li><a class=tag href=https://retrobute.github.io/tags/networking/>Networking</a><li><a class=tag href=https://retrobute.github.io/tags/cybersecurity/>Cybersecurity</a></ul><br></div><div id=buttons-container><details class=closable id=toc><summary title="Table of Contents"><i class=icon></i></summary> <div><strong class=title>Table of Contents</strong><div><ul><li><a href=https://retrobute.github.io/blog/bcp38/#what-is-bcp38>What Is BCP38?</a><li><a href=https://retrobute.github.io/blog/bcp38/#why-bcp38-matters>Why BCP38 Matters</a><ul><li><a href=https://retrobute.github.io/blog/bcp38/#example-ddos-amplification-attack>Example: DDoS Amplification Attack</a></ul><li><a href=https://retrobute.github.io/blog/bcp38/#how-bcp38-works>How BCP38 Works</a><ul><li><a href=https://retrobute.github.io/blog/bcp38/#1-unicast-reverse-path-forwarding-urpf>1. Unicast Reverse Path Forwarding (uRPF)</a><li><a href=https://retrobute.github.io/blog/bcp38/#2-access-control-lists-acls>2. Access Control Lists (ACLs)</a></ul><li><a href=https://retrobute.github.io/blog/bcp38/#inability-to-block-in-range-spoofed-ip-addresses>Inability to Block In-Range Spoofed IP Addresses</a><li><a href=https://retrobute.github.io/blog/bcp38/#conlusion>Conlusion</a></ul></div></div></details><a title="Go to Top" href=#top id=go-to-top><i class=icon></i></a><a href="https://shareopenly.org/share/?url=https://retrobute.github.io/blog/bcp38/&text=How%20BCP38%20acts%20as%20the%20frontline%20defense%20against%20IP%20spoofing%2C%20securing%20networks%20and%20mitigating%20DDoS%20attacks.%20%28my%20very%20first%20blog%20post%20lol%29" id=share title=Share><i class=icon></i></a><a title="File an Issue" href=https://github.com/Retrobute/retrobute.github.io/issues id=issue><i class=icon></i></a></div><p><img alt="Nature Image" src=https://res.cloudinary.com/dly5kd3h5/image/upload/v1747465704/nature-image_qr7ang.webp#end><h2 id=what-is-bcp38>What Is BCP38?</h2><p>BCP38 (Best Current Practice 38), also known as <strong>Ingress Filtering</strong> and defined in <strong>RFC 2827</strong>, is a security standard designed to prevent <strong>IP spoofing</strong> at the network edge. By validating source IP addresses, it ensures only legitimate traffic enters or exits a network.<h2 id=why-bcp38-matters>Why BCP38 Matters</h2><p>To understand BCP38â€™s importance, we must first examine the risks posed by IP spoofing. While IP spoofing itself isnâ€™t inherently malicious, it enables high-impact attacks such as:<ul><li><strong>DDoS Amplification Attacks</strong><li><strong>Anonymized Network Scans</strong><li><strong>Bypassing Access Controls</strong></ul><h3 id=example-ddos-amplification-attack>Example: DDoS Amplification Attack</h3><p>Letâ€™s break down how a DDoS amplification attack unfolds:<p><strong>Attack Workflow</strong>:<ul><li>The attacker sends <strong>crafted requests</strong> to these open services, <strong>spoofing the source IP address</strong> to match the victimâ€™s IP.<li>If BCP38 is <strong>not enforced</strong>, these spoofed packets reach the open services unchecked.<li>Each service responds to the victimâ€™s IP, flooding it with traffic.<li>The victimâ€™s resources are overwhelmed, leading to service downtime.</ul><p>BCP38 disrupts this chain by blocking spoofed packets at the source networkâ€™s edge.<blockquote class=note><p class=alert-title><i class=icon></i>Note<p>BCP38, Despite being published in 2000, many ISPs still neglect BCP38 implementation. This gap explains why spoofed traffic remains prevalent in large-scale attacks.</blockquote><hr><h2 id=how-bcp38-works>How BCP38 Works</h2><p>BCP38 enforces <strong>ingress filtering</strong> on edge router interfaces. It verifies whether incoming packetsâ€™ source IP addresses align with the networkâ€™s valid IP prefixes. Two primary implementation methods exist:<h3 id=1-unicast-reverse-path-forwarding-urpf>1. Unicast Reverse Path Forwarding (uRPF)</h3><p><strong>uRPF</strong> is the most efficient method for implementing BCP38 on Cisco devices. It cross-checks a packetâ€™s source IP against the routerâ€™s routing table to validate legitimacy.<p><strong>Modes of Operation</strong>:<ul><li><strong>Strict Mode</strong>: Drops packets if the source IP isnâ€™t reachable via the interface they arrived on. <em>Best for symmetric routing environments</em>.<li><strong>Loose Mode</strong>: Only checks if the source IP exists in the routing table, regardless of the interface. <em>Useful for asymmetric routing (less secure)</em>.</ul><p><strong>Configuration Example</strong>:<br> Enable uRPF in strict mode on a Cisco interface:<pre class="language-cisco z-code" data-lang=cisco><code class=language-cisco data-lang=cisco><span class="z-text z-plain">interface GigabitEthernet0/0
</span><span class="z-text z-plain">ip verify unicast source reachable-via rx
</span></code></pre><ul><li><code>rx</code> enables strict mode.<li>For loose mode, replace <code>rx</code> with <code>any</code>:</ul><pre class="language-cisco z-code" data-lang=cisco><code class=language-cisco data-lang=cisco><span class="z-text z-plain">ip verify unicast source reachable-via any
</span></code></pre><h3 id=2-access-control-lists-acls>2. Access Control Lists (ACLs)</h3><p>ACLs provide an alternative method to implement BCP38 by filtering packets based on their source IP addresses. This approach explicitly allows only packets with source IPs from your networkâ€™s range and denies all others. While less scalable than uRPF, itâ€™s useful when uRPF isnâ€™t practical, such as in asymmetric routing scenarios.<p><strong>How it works ?</strong><ul><li>Define an ACL that permits packets with source IPs matching your networkâ€™s range.<li>Apply the ACL outbound on interfaces to ensure only legitimate traffic exits.</ul><p><strong>Configuration Example</strong>:<p>Suppose your network uses the IP range <mark>192.168.32.0/24</mark>. Configure an ACL like this:<pre class="language-cisco z-code" data-lang=cisco><code class=language-cisco data-lang=cisco><span class="z-text z-plain">access-list 101 permit ip 192.168.32.0 0.0.0.255 any
</span><span class="z-text z-plain">access-list 101 deny ip any any
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">interface GigabitEthernet0/1
</span><span class="z-text z-plain"> ip access-group 101 out
</span></code></pre><ul><li>This allows only packets with source IPs in <mark>192.168.32.0/24</mark> to leave the interface.</ul><h2 id=inability-to-block-in-range-spoofed-ip-addresses>Inability to Block In-Range Spoofed IP Addresses</h2><p>BCP38 effectively filters out packets with source IP addresses that fall outside the networkâ€™s legitimate range. However, it cannot prevent spoofing of IP addresses within the allowed range. For example, an attacker inside the network or one who spoofs an in-range IP (e.g., from a compromised device) can still send malicious packets through the gateway. This limitation means BCP38 offers no protection against internal threats or attacks that exploit legitimate IP ranges, requiring additional security measures to address such risks.<h2 id=conlusion>Conlusion</h2><p>While BCP38 plays a crucial role in preventing such threats, it is not sufficient on its own. It represents just one of many measures and standards used to mitigate these types of attacks.</article><span class=hidden id=copy-code-text>Copy Code</span><span class=hidden id=search-index>https://retrobute.github.io/search_index.en.json</span><span class=hidden id=more-matches-text>$MATCHES more matches</span></main><footer id=site-footer><p>Â© retrobute.github.io, 2025<ul id=socials><li><a rel=" me" href=https://github.com/Retrobute title=GitHub> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EGitHub%3C/title%3E%3Cpath d='M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12'/%3E%3C/svg%3E&#34)" class=icon></i> <span>GitHub</span> </a><li><a rel=" me" href=https://t.me/Retrobute title=Telegram> <i class=icon style=--icon:url(data:image/svg+xml,%3Csvg%20width%3D%2224px%22%20height%3D%2224px%22%20viewBox%3D%220%200%2024%2024%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%3Cpath%20d%3D%22m20.665%203.717-17.73%206.837c-1.21.486-1.203%201.161-.222%201.462l4.552%201.42%2010.532-6.645c.498-.303.953-.14.579.192l-8.533%207.701h-.002l.002.001-.314%204.692c.46%200%20.663-.211.921-.46l2.211-2.15%204.599%203.397c.848.467%201.457.227%201.668-.785l3.019-14.228c.309-1.239-.473-1.8-1.282-1.434z%22/%3E%3C/svg%3E)></i> <span>Telegram</span> </a><li><a rel=" me" href=mailto:rustedcobalt@gmail.com title=Mail> <i style="--icon:url(&#34data:image/svg+xml,%3Csvg role='img' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3EGmail%3C/title%3E%3Cpath d='M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z'/%3E%3C/svg%3E&#34)" class=icon></i> <span>Mail</span> </a></ul></footer>